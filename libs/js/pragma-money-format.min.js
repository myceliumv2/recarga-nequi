/**
 * pragma-money-format
 * Personalized money Format for inputs and filter
 * @version v1.0.2
 */
angular.module("pragmaMoneyFormat",[]).factory("pragmaMoneyFormatProvider",["$filter",function(a){function c(a){b.defaultOptions=angular.extend({},b.defaultOptions,a)}function d(a,c,d){d=d?angular.extend({},b.defaultOptions,d):b.defaultOptions;var e=a?String(a):"0",i="",j="",k=d.thousandsSeparator,l=d.decimalSeparator,m=d.suffix,n=d.prefix,o=d.decimalLimit,p=d.insertPlusSign,q=d.allowNegative,r=d.limit,s=h(g(e,r),o);c&&(k="",l=b.defaultDecimalSeparator,m="",n=""),0===o&&(l="",j=""),j=s.substr(s.length-o,o);var t=s.substr(0,s.length-o);return s=0===o?t:t+l+j,(k||""!==k.trim())&&(i=f(t,k),s=0===o?i:i+l+j),!q||0===t&&0===j||(s=-1!==e.indexOf("-")&&e.indexOf("+")<e.indexOf("-")?"-"+s:p?"+"+s:""+s),n&&(s=n+s),m&&(s+=m),s}function e(a,c,d){var e=b.defaultDecimalSeparator,f="",g="",h=a?String(a):"0",i="";return d=d?angular.extend({},b.defaultOptions,d):b.defaultOptions,c=c||e,f=-1!==h.indexOf(c)?h.substring(h.indexOf(c)+c.length):"",g=-1!==h.indexOf(c)?h.substring(0,h.indexOf(c)):h,g=g.replace(/[^0-9]/,"")||"0",f=f.replace(/[^0-9]/,""),i=Number(g+e+f).toFixed(d.decimalLimit),i=-1!==h.indexOf("-")?"-"+i:i}function f(a,b){for(var c="",d=0,e=null,f=a.length;f>0;f--)e=a.substr(f-1,1),d++,d%3==0&&(e=b+e),c=e+c;return c.substr(0,1)===b&&(c=c.substring(1,c.length)),c}function g(a,b){for(var c="",d="",e=0;e<a.length;e++)d=a.charAt(e),0===c.length&&"0"===d&&(d=!1),d&&i(d)&&(b?c.length<b&&(c+=d):c+=d);return c}function h(a,b){for(;a.length<b+1;)a="0"+a;return a}function i(a){var b=/[0-9]/;return a.match(b)}var b={defaultOptions:{prefix:"$ ",suffix:"",decimalSeparator:".",thousandsSeparator:",",limit:!1,decimalLimit:2,allowNegative:!1,insertPlusSign:!1,minAmmount:0,maxAmmount:null},overrideDefaultOptions:c,formatNumber:d,formatThousands:f,defaultDecimalSeparator:".",isNumber:i,formatMoneyWithDecimals:e};return b}]).directive("pragmaInputMoneyFormat",["pragmaMoneyFormatProvider","$filter",function(a,b){return{require:"?ngModel",restrict:"A",replace:!0,scope:{pragmaMoneyFormats:"="},link:function(b,c,d,e){function g(a){e.$viewValue!==a&&(e.$setViewValue(a),e.$render())}var f=null;f=b.pragmaMoneyFormats?angular.extend({},a.defaultOptions,b.pragmaMoneyFormats):a.defaultOptions,e.$parsers.unshift(function(b){var c=null,d=null;return e.$isEmpty(b)&&(b=0,d=0),c=a.formatNumber(b,!1,f),d=Number(a.formatNumber(b,!0,f))||0,g(c),d}),e.$formatters.unshift(function(b){var d=null;return e.$isEmpty(b)&&(b=0),d=a.formatMoneyWithDecimals(b),a.formatNumber(d,!1,f)}),e.$validators.pragmaMinMoneyAmmount=function(d,e){return f=angular.extend({},a.defaultOptions,b.pragmaMoneyFormats),d>=f.minAmmount},e.$validators.pragmaMaxMoneyAmmount=function(d,e){return f=angular.extend({},a.defaultOptions,b.pragmaMoneyFormats),!f.maxAmmount||d<=f.maxAmmount},c.on("keyup",function(){var a=e.$viewValue?e.$viewValue.length:0;c[0].setSelectionRange(a,a)})}}}]).filter("pragmaMoneyFilter",["pragmaMoneyFormatProvider",function(a){return function(b,c,d){c=c?angular.extend({},a.defaultOptions,c):a.defaultOptions;var e=c.prefix,f=c.suffix,g=c.decimalLimit,h=c.decimalSeparator,i=c.allowNegative,j=c.insertPlusSign,k="",l=c.thousandsSeparator,m=b?String(b):"0",n="",o="",q="";return d=d||a.defaultDecimalSeparator,q=String(a.formatMoneyWithDecimals(m,d,c)),q=Number(q).toFixed(g),i&&-1!==m.indexOf("-")?k="-":j&&(k="+"),0===g?(n="",h="",o=q):(n=-1!==q.indexOf(d)?q.substring(q.indexOf(d)+d.length):"",o=-1!==q.indexOf(d)?q.substring(0,q.indexOf(d)):q,o=o.replace(/[^0-9]/,"")),o=a.isNumber(o)?a.formatThousands(o,l):"0",q=o+h+n,e+k+q+f}}]);